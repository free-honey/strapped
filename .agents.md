# Strapped DApp â€“ Agent Notes

- **Purpose:** Fuel-based craps-like game. Repo holds Sway contracts, Rust deploy/indexer/TUI, and integration tests. Everything needed to run against devnet (or local later).
- **Tooling:** Rust 2024, `fuels` 0.76 (patched), forc 0.70.1, forc-wallet. Wallets live in `~/.fuel/wallets/<name>.wallet`.
- **Key crates:** `rust-crates/deploy-cli` (deploy strapped + pseudo-VRF; writes `.deployments/{dev,test,local}`), `rust-crates/indexer` (streams receipts via Fuel indexer GraphQL; snapshots in `strapped_indexer_data/<net>`), `rust-crates/tui` (game client), `rust-crates/generated_abi` (auto-gen), `integration-tests` (requires node + wallets).
- **Devnet quick run (with o2 port-forward):**
  1) Wallet: `forc-wallet --path ~/.fuel/wallets/alice.wallet new` (or `import`), then fund via https://faucet-devnet.fuel.network/ after getting address (`forc wallet --path ~/.fuel/wallets/alice.wallet list`).
  2) Port-forward RPC: `aws eks update-kubeconfig --name fuel-dev-2-hybrid --region us-east-1` then `kubectl port-forward -n devnet-0 pod/fuelcore-sentry-o2-0 4000:4000`.
  3) Indexer: `cargo run -p indexer -- --graphql-url http://127.0.0.1:4000/graphql --port 5000 --tracing --dev` (uses `.deployments/dev` to pick contract id/start height).
  4) TUI: `cargo run -p tui -- --devnet --wallet alice --indexer-url http://127.0.0.1:5000`.
- **Deploying:** `cargo run -p deploy-cli -- --devnet --wallet <name> [--rpc-url <url>]` builds & deploys strapped + pseudo-VRF, initializes, funds, and appends metadata.
- **Snapshots/data:** Indexed state under `strapped_indexer_data/<net>/events` + `snapshots`; persists across runs. Pass `--snapshot-dir` to override.
- **Common flags:** Indexer `--contract-id`, `--start-height`, `--port`, `--tracing`; TUI `--fake-vrf`, `--wallet-dir`, `--rpc-url`, `--indexer-url`.
- **Notes:** Do not delete existing user changes; avoid `git reset --hard`. ASCII only unless file already uses Unicode. Prefer `rg` for search.
- use `cargo +nightly` when running `fmt`, we set additional configurations for formatting in `.rustfmt.toml` and using `+nightly` makes sure those are included.
- can use `xtask` to rebuild and test: 
  - Build Sway contracts + regenerate ABI: `cargo xtask abi`
  - Just build the Sway projects: `cargo xtask build-sway`
  - Clippy (warnings as errors): `cargo xtask clippy`
  - Integration tests (builds Sway + ABI first): `cargo xtask test`